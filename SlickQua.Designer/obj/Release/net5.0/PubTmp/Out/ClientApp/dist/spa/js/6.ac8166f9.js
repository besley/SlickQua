(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"3e4f":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("q-table",{attrs:{title:"",data:e.taskdata,columns:e.columns,"row-key":"TaskID",selection:"single",selected:e.selected},on:{"row-click":e.onToDoTaskRowClick,"update:selected":function(t){e.selected=t}}}),a("q-btn",{staticStyle:{"margin-right":"10px"},attrs:{label:e.ui.refresh,icon:"refresh",color:"primary"},on:{click:e.onRefreshClick}})],1)},s=[],i=a("ded3"),n=a.n(i),r=a("2f62"),l=a("0891"),c={name:"ToDo",props:["processid","formid"],created(){this.$root.$refs.todocomponent=this,this.$root.$on("todotask-loadTasks",(e=>{this.taskQuery=e,this.onLoadToDoTasks(e)}))},data(){return{ui:{refresh:this.gmxGetTitle("refresh")},columns:[{name:"taskID",label:"ID",align:"left",field:"TaskID"},{name:"appName",label:this.gmxGetTitle("AppName"),align:"left",field:"AppName"},{name:"appInstanceCode",label:this.gmxGetTitle("AppInstanceCode"),align:"left",field:"AppInstanceCode"},{name:"activityName",align:"left",label:this.gmxGetTitle("ActivityName"),field:"ActivityName"},{name:"createdDateTime",label:this.gmxGetTitle("CreatedDateTime"),field:"CreatedDateTime",sortable:!0},{name:"activityState",label:this.gmxGetTitle("ActivityState"),field:"ActivityState",sortable:!0},{name:"assignedToUserID",label:this.gmxGetTitle("AssignedToUserID"),field:"AssignedToUserID",sortable:!0},{name:"assignedToUserName",label:this.gmxGetTitle("AssignedToUserName"),field:"AssignedToUserName",sortable:!0},{name:"endedDateTime",label:this.gmxGetTitle("EndedDateTime"),field:"EndedDateTime",sortable:!0},{name:"endedByUserName",label:this.gmxGetTitle("EndedByUserName"),field:"EndedByUserName",sortable:!0}],taskQuery:null,taskdata:[],selected:[]}},methods:n()(n()(n()(n()({},Object(r["b"])("task",["getToDo"])),Object(r["b"])("workflow",["getTaskFieldActivityPermission"])),Object(r["c"])("task",["todotasks"])),{},{onLoadToDoTasks(e){var t=this,a={Query:e,callback:function(e){1===e.Status?t.taskdata=t.todotasks():console.log(e.Message)}};this.getToDo(a)},onToDoTaskRowClick(){var e=this,t=this.selected[0];if(null!==t){var a=t.TaskID,o={Query:{TaskID:a,ProcessID:this.processid,FormID:this.formid},callback:function(t){1===t.Status?e.$root.$emit("workflow-setFieldActivityEditList",t.Entity):l["a"].error(e.gmxGetTitle("FormContent.loadActivityPermission.error"),t.Message)}};e.getTaskFieldActivityPermission(o)}},onRefreshClick(){this.onLoadToDoTasks(this.taskQuery)}})},d=c,m=a("2877"),u=a("9989"),h=a("eaac"),f=a("9c40"),p=a("eebe"),g=a.n(p),k=Object(m["a"])(d,o,s,!1,null,null,null);t["default"]=k.exports;g()(k,"components",{QPage:u["a"],QTable:h["a"],QBtn:f["a"]})},5221:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("div",{staticClass:"row",staticStyle:{"margin-left":"10px"}},[a("div",{staticClass:"col"},[a("h5",[e._v(e._s(e.ui.forminfo))]),a("div",{staticClass:"row",staticStyle:{"margin-top":"10px"}},[a("q-btn",{attrs:{label:e.ui.deleteinstance,color:"primary",icon:"delete"},on:{click:e.onDeleteFormContentClick}}),a("q-btn",{attrs:{label:e.ui.processdiagram,color:"green",icon:"insights"},on:{click:e.onProcessDiagramClick}}),a("q-btn",{attrs:{label:e.ui.refresh,color:"orange",icon:"refresh"},on:{click:e.onRefreshClick}})],1),a("div",{staticClass:"row"},[a("q-table",{attrs:{title:"",data:e.formContentData,columns:e.columns,"row-key":"ID",selection:"single",selected:e.selectedFormContent},on:{"update:selected":function(t){e.selectedFormContent=t},"row-click":e.onFormConentRowClick}})],1),a("div",{staticClass:"row"},[a("q-tabs",{staticClass:"text-grey",attrs:{dense:"","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},model:{value:e.leftTab,callback:function(t){e.leftTab=t},expression:"leftTab"}},[a("q-tab",{attrs:{icon:"basic",name:"todo",label:e.ui.todotask}}),a("q-tab",{attrs:{icon:"advanced",name:"done",label:e.ui.donetask}})],1),a("q-tab-panels",{attrs:{animated:""},model:{value:e.leftTab,callback:function(t){e.leftTab=t},expression:"leftTab"}},[a("q-tab-panel",{attrs:{name:"todo"}},[a("todo",{ref:"mytodotasks",attrs:{processid:e.processID,formid:e.formID}})],1),a("q-tab-panel",{attrs:{name:"done"}},[a("done")],1)],1)],1)]),a("div",{staticClass:"col"},[a("h5",[e._v(e._s(e.ui.formcontent))]),a("div",{staticClass:"row"},[a("q-btn",{attrs:{label:e.ui.startup,color:"green",icon:"build_circle"},on:{click:e.onStartupClick}}),a("q-btn",{attrs:{label:e.ui.forward,color:"orange",icon:"forward"},on:{click:e.onForwardClick}}),a("q-btn",{attrs:{label:e.ui.save,color:"primary",icon:"save"},on:{click:e.onSaveClick}}),a("q-btn",{attrs:{label:e.ui.return,color:"orange",icon:"keyboard_return"},on:{click:e.onReturnClick}})],1),a("div",{staticStyle:{"margin-top":"10px"}},[a("grid-layout",{ref:"gridlayout",attrs:{layout:e.layout,"col-num":e.colNum,"row-height":40,"is-draggable":!1,"is-resizable":!1,"is-mirrored":!1,"vertical-compact":!1,"auto-size":!0,margin:[10,10],"use-css-transforms":!0},on:{"update:layout":function(t){e.layout=t}}},e._l(e.layout,(function(t){return a("grid-item",{key:t.uuid,attrs:{x:t.x,y:t.y,w:t.w,h:t.h,i:t.i}},[a(t.c,{tag:"component",attrs:{uuid:t.uuid},model:{value:t.val,callback:function(a){e.$set(t,"val",a)},expression:"item.val"}})],1)})),1)],1)])])])},s=[],i=a("ded3"),n=a.n(i),r=a("00a0"),l=a("1157"),c=a.n(l),d=a("7be8"),m=a("2f62"),u=a("0891"),h=a("f82d"),f=a("4d69"),p=a("480a"),g=a("ce88"),k=a("0d35"),T=a("113d"),b=a("1258"),C=a("2ae1"),D=a("0b4a"),y=a("0446"),v=a("6b0f"),I=a("0cf0"),F=a("ff7b2"),x=a("18df"),G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-dialog",{ref:"dialog",on:{hide:e.onDialogHide}},[a("q-card",{staticClass:"q-dialog-plugin"},[a("q-card-section",{staticStyle:{height:"400px"}},[a("h4",[e._v(e._s(e.ui.steptitle))]),a("q-tree",{ref:"nextsteptree",staticClass:"col-12 col-sm-6",attrs:{nodes:e.steps,"node-key":"label","tick-strategy":"leaf-filtered",ticked:e.ticked,expanded:e.expanded},on:{"update:ticked":function(t){e.ticked=t},"update:expanded":function(t){e.expanded=t}}})],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"OK"},on:{click:e.onOKClick}}),a("q-btn",{attrs:{color:"primary",label:"Cancel"},on:{click:e.onCancelClick}})],1)],1)],1)},N=[],w=a("bc3a"),U=a.n(w),P={name:"NextStepTree",props:["task","conditions"],created(){var e=this;this.getNextSteps((function(t){e.steps=t,e.$nextTick((()=>{e.$refs.nextsteptree.expandAll()}))}))},data(){return{ui:{steptitle:this.gmxGetTitle("steptitle")},steps:[],ticked:null,expanded:null}},methods:n()(n()({},Object(m["c"])("account",["loginUser"])),{},{show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},onOKClick(){this.runProcess(),this.$emit("ok"),this.hide()},onCancelClick(){this.hide()},getNextSteps(e){var t=this.task,a={};a.ProcessGUID=t.ProcessGUID,a.Version=t.Version,a.AppInstanceID=t.AppInstanceID,a.TaskID=t.TaskID,a.Conditions=this.conditions,U.a.post("/sqdapi/api/wf2xml/GetNextStepInfo",a).then((t=>{var a=t.data;if(1===a.Status){var o=a.Entity.NextActivityRoleUserTree,s=[];this.makeTreeStepNodes(o,s),e&&e(s)}else u["a"].error(a.Message)})).catch((e=>{console.log(e)}))},makeTreeStepNodes(e,t){var a={label:"Next Step",children:[],type:"root"};t.push(a),c.a.each(e,(function(e,t){var o={label:t.ActivityName,id:t.ActivityGUID,children:[],type:"activity"};c.a.each(t.Users,(function(e,a){var s={label:a.UserName,id:a.UserID,activity:t.ActivityGUID,type:"user"};o.children.push(s)})),a.children.push(o)}))},runProcess(){var e={},t=this.$refs.nextsteptree.getTickedNodes();function a(e,t){var a=t.activity;void 0===e[a]&&(e[a]=[]);var o={UserID:t.id,UserName:t.label};e[a].push(o)}function o(e,t){var a=t.id;void 0===e[a]&&(e[a]=[]),e[a]=[]}c.a.each(t,(function(t,s){"user"===s.type?a(e,s):"activity"===s.type?o(e,s):u["a"].warn(this.gmxGetTitle("NextStepTree.runProcess.warn"))}));var s=this.task,i={};i.ProcessGUID=s.ProcessGUID,i.Version=s.Version,i.AppName=s.AppName,i.AppInstanceID=s.AppInstanceID,i.TaskID=s.TaskID,i.NextActivityPerformers=e,i.UserID=s.AssignedToUserID,i.UserName=s.AssignedToUserName,i.Conditions=this.conditions,U.a.post("/sqdapi/api/wf2xml/RunProcess",i).then((e=>{var t=e.data;1===t.Status?u["a"].info(this.gmxGetTitle("NextStepTree.runProcess.ok")):u["a"].error(t.Message)})).catch((e=>{window.console.log(e)}))}})},S=P,A=a("2877"),$=a("24e8"),q=a("f09f"),E=a("a370"),Q=a("7f41"),O=a("4b7e"),L=a("9c40"),R=a("eebe"),_=a.n(R),V=Object(A["a"])(S,G,N,!1,null,null,null),j=V.exports;_()(V,"components",{QDialog:$["a"],QCard:q["a"],QCardSection:E["a"],QTree:Q["a"],QCardActions:O["a"],QBtn:L["a"]});var M={name:"Running",created(){this.formID=this.$route.params.id,this.loadFormProcess(this.formID),this.loadFormContentList(this.formID),this.openFormTemplate(this.formID)},mounted(){var e=this;this.$root.$on("workflow-setFieldActivityEditList",(t=>{e.checkFieldInActivityFormVisibleReadOnly(t)}))},components:{GridLayout:d["GridLayout"],GridItem:d["GridItem"],Label:h["a"],Button:f["a"],Hyperlink:p["a"],Textbox:g["a"],Textarea:k["a"],EMail:T["a"],Dropdown:b["a"],List:C["a"],Radio:D["a"],Checkbox:y["a"],Date:v["a"],Time:I["a"],Slider:F["a"],Uploader:x["a"],todo:a("3e4f").default,done:a("d3c8").default},data(){return{ui:{forminfo:this.gmxGetTitle("forminfo"),formcontent:this.gmxGetTitle("formcontent"),deleteinstance:this.gmxGetTitle("deleteinstance"),processdiagram:this.gmxGetTitle("processdiagram"),startup:this.gmxGetTitle("startup"),forward:this.gmxGetTitle("forward"),save:this.gmxGetTitle("save"),refresh:this.gmxGetTitle("refresh"),return:this.gmxGetTitle("return"),todotask:this.gmxGetTitle("todotask"),donetask:this.gmxGetTitle("donetask")},formID:0,processID:0,currentForm:null,currentProcess:null,colNum:12,layout:[],selectedFormContent:[],formContentData:[],columns:[{name:"ID",label:"ID",align:"left",field:"ID"},{name:"formID",label:this.gmxGetTitle("formid"),align:"left",field:"FormID"},{name:"createdUserName",label:this.gmxGetTitle("createdUserName"),align:"left",field:"CreatedUserName"},{name:"createdDatetime",label:this.gmxGetTitle("createdDatetime"),align:"left",field:"CreatedDatetime"},{name:"lastUpdatedUserName",label:this.gmxGetTitle("lastUpdatedUserName"),align:"left",field:"LastUpdatedUserName"},{name:"lastUpdatedDatetime",label:this.gmxGetTitle("lastUpdatedDatetime"),align:"left",field:"LastUpdatedDatetime"}],leftTab:"todo",todoTaskQuery:null}},methods:n()(n()(n()(n()({},Object(m["b"])("form",["getForm","getFormFieldComp"])),Object(m["b"])("workflow",["getFormProcess"])),Object(m["b"])("content",["getContent","getContentList","saveContent","deleteContent","startupContent","forwardContent"])),{},{loadFormProcess(e){var t=this,a={FormID:e,callback:function(e){1===e.Status?null!==e.Entity?(t.currentProcess={ProcessID:e.Entity.ProcessID,ProcessGUID:e.Entity.ProcessGUID,ProcessName:e.Entity.ProcessName,Version:e.Entity.ProcessVersion},t.processID=t.currentProcess.ProcessID):u["a"].warn(t.gmxGetTitle("FormContent.loadFormProcess.nonebinding.warn")):u["a"].error(t.gmxGetTitle("FormContent.loadFormProcess.error"),e.Message)}};this.getFormProcess(a)},openFormTemplate(e){var t=this,a={ID:e,callback:function(e){if(1===e.Status){t.currentForm=e.Entity.Form;var a=e.Entity.Form.TemplateContent;t.layout=c.a.parseJSON(a),setTimeout((function(){var a=e.Entity.FormFieldList;t.renderComponentControl(a)}),100)}else u["a"].error(t.gmxGetTitle("Form.openFormTemplate.error"),e.Message)}};this.getFormFieldComp(a)},renderComponentControl(e){var t=this;c.a.each(e,(function(e,a){var o=a.FieldType,s=r["a"].setEmitRenderContainerFunctionName(o,a.FieldGUID);t.$root.$emit(s,a)}))},onDeleteFormContentClick(){var e=this;u["a"].confirm(this.gmxGetTitle("FormContent.deleteFormContent.confirm"),(function(){if(1===e.selectedFormContent.length){var t=e.selectedFormContent[0].ID,a={FormContentID:t,callback:function(t){1===t.Status?e.loadFormContentList(e.formID):u["a"].error(e.gmxGetTitle("FormContent.deleteFormContent.error"),t.Message)}};e.deleteContent(a)}else u["a"].warn(e.gmxGetTitle("FormContent.deleteFormContent.noneselected.warn"))}))},onProcessDiagramClick(){if(1===this.selectedFormContent.length){var e=this.selectedFormContent[0].ID,t=this.currentProcess.ProcessGUID,a=this.currentProcess.Version;window.open("/sfd2/Diagram?AppInstanceID="+e+"&ProcessGUID="+t+"&Version="+a+"&Mode=READONLY")}else u["a"].warn(this.gmxGetTitle("FormContent.showProcessDiagram.noneselected.warn"))},loadFormContentList(e){var t=this,a={FormID:e,callback:function(e){1===e.Status?t.formContentData=e.Entity:u["a"].error(t.gmxGetTitle("FormContent.loadFormContentList.error"),e.Message)}};this.getContentList(a)},onFormConentRowClick(){var e=this.selectedFormContent[0];if(null!==e){var t=e.ID,a=this,o={FormContentID:t,callback:function(e){1===e.Status?(a.layout=c.a.parseJSON(e.Entity.FormContent),a.loadToDoTasks(),a.loadDoneTasks()):u["a"].error(a.gmxGetTitle("FormContent.getContent.error"),e.Message)}};a.getContent(o)}},onRefreshClick(){var e=this.$route.params.id;this.loadFormContentList(e)},onStartupClick(){var e=this,t=0,a=this.$route.params.id;if(1===this.selectedFormContent.length&&(t=this.selectedFormContent[0].ID),null!==this.currentForm&&null!==this.currentProcess&&0!==t){var o=this.getConditions(this.layout),s={Query:{FormContent:{ID:t,FormID:a,FormContent:JSON.stringify(e.layout)},Runner:{ProcessGUID:e.currentProcess.ProcessGUID,Version:e.currentProcess.ProcessVersion,AppName:e.currentForm.FormName,AppInstanceID:t.toString(),Conditions:o,UserID:"01",UserName:"Zero"}},callback:function(t){1===t.Status?u["a"].info(e.gmxGetTitle("FormContent.onStartup.ok")):u["a"].error(e.gmxGetTitle("FormContent.onStartup.error"),t.Message)}};this.startupContent(s)}else u["a"].error(e.gmxGetTitle("FormContent.onStartup.noneformcontent.warn"))},onForwardClick(){if(void 0!==this.$refs.mytodotasks&&void 0!==this.$refs.mytodotasks.selected[0]){var e=this.$refs.mytodotasks.selected[0],t=this.getConditions(this.layout);this.$q.dialog({component:j,parent:this,text:"NextStepTree",task:e,conditions:t}).onOk((()=>{this.$root.$emit("todotask-loadTasks",this.todoTaskQuery)})).onCancel((()=>{})).onDismiss((()=>{}))}else u["a"].warn(this.gmxGetTitle("FormContent.showStepDialog.nonetodotask.warn"))},getConditions(e){var t=this,a={};return c.a.each(e,(function(e,o){var s=o.val,i=r["a"].gatherEmitFieldObjectFunctionName(o.c,o.uuid);t.$root.$emit(i,(function(e){null!==e&&""!==e.ConditionKey&&(a[e.ConditionKey]=s)}))})),a},onSaveClick(){var e=this,t=0,a=this.$route.params.id;1===this.selectedFormContent.length&&(t=this.selectedFormContent[0].ID);var o={FormContent:{ID:t,FormID:a,FormContent:JSON.stringify(e.layout)},callback:function(t){1===t.Status?u["a"].info(e.gmxGetTitle("FormContent.onSave.ok")):u["a"].error(e.gmxGetTitle("FormContent.onSave.error"),t.Message)}};this.saveContent(o)},onReturnClick(){window.close()},loadToDoTasks(){var e={ProcessGUID:this.currentProcess.ProcessGUID,Version:this.currentProcess.Version,AppName:this.currentForm.FormName,AppInstanceID:this.selectedFormContent[0].ID.toString()};this.todoTaskQuery=e,this.$root.$emit("todotask-loadTasks",e)},loadDoneTasks(){var e={ProcessGUID:this.currentProcess.ProcessGUID,Version:this.currentProcess.Version,AppName:this.currentForm.FormName,AppInstanceID:this.selectedFormContent[0].ID.toString()};this.$root.$emit("donetask-loadTasks",e)},checkFieldInActivityFormVisibleReadOnly(e){var t=this;c.a.each(e,(function(e,a){var o=a.FieldGUID,s=t.findCtrlType(t.layout,o);if(""!==s){console.log("set permission...");var i=r["a"].setEmitBindingControlPermissionName(s,o);console.log(i),t.$root.$emit(i,a)}else console.log("control type is null")}))},findCtrlType(e,t){var a="";return c.a.each(e,(function(e,o){if(o.uuid===t)return a=o.c,!1})),a}})},B=M,J=a("9989"),K=a("eaac"),H=a("429b"),z=a("7460"),Y=a("adad"),Z=a("823b"),W=Object(A["a"])(B,o,s,!1,null,null,null);t["default"]=W.exports;_()(W,"components",{QPage:J["a"],QBtn:L["a"],QTable:K["a"],QTabs:H["a"],QTab:z["a"],QTabPanels:Y["a"],QTabPanel:Z["a"]})},d3c8:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("q-table",{attrs:{title:"",data:e.taskdata,columns:e.columns,"row-key":"TaskID"}}),a("q-btn",{staticStyle:{"margin-right":"10px"},attrs:{label:e.ui.refresh,icon:"refresh",color:"primary"},on:{click:e.onRefreshClick}})],1)},s=[],i=a("ded3"),n=a.n(i),r=a("2f62"),l={name:"ToDo",created(){this.$root.$on("donetask-loadTasks",(e=>{this.taskQuery=e,this.onLoadDoneTasks(e)}))},data(){return{ui:{refresh:this.gmxGetTitle("refresh")},columns:[{name:"taskID",label:"ID",align:"left",field:"TaskID"},{name:"appName",label:this.gmxGetTitle("AppName"),align:"left",field:"AppName"},{name:"appInstanceCode",label:this.gmxGetTitle("AppInstanceCode"),align:"left",field:"AppInstanceCode"},{name:"activityName",align:"left",label:this.gmxGetTitle("ActivityName"),field:"ActivityName"},{name:"createdDateTime",label:this.gmxGetTitle("CreatedDateTime"),field:"CreatedDateTime",sortable:!0},{name:"activityState",label:this.gmxGetTitle("ActivityState"),field:"ActivityState",sortable:!0},{name:"assignedToUserName",label:this.gmxGetTitle("AssignedToUserName"),field:"AssignedToUserName",sortable:!0},{name:"endedDateTime",label:this.gmxGetTitle("EndedDateTime"),field:"EndedDateTime",sortable:!0},{name:"endedByUserName",label:this.gmxGetTitle("EndedByUserName"),field:"EndedByUserName",sortable:!0}],taskQuery:null,taskdata:[],selected:[]}},methods:n()(n()(n()({},Object(r["b"])("task",["getDone"])),Object(r["c"])("task",["donetasks"])),{},{onLoadDoneTasks(e){var t=this,a={Query:e,callback:function(e){1===e.Status?t.taskdata=e.Entity:console.log(e.Message)}};this.getDone(a)},onRefreshClick(){this.onLoadDoneTasks(this.taskQuery)}})},c=l,d=a("2877"),m=a("9989"),u=a("eaac"),h=a("9c40"),f=a("eebe"),p=a.n(f),g=Object(d["a"])(c,o,s,!1,null,null,null);t["default"]=g.exports;p()(g,"components",{QPage:m["a"],QTable:u["a"],QBtn:h["a"]})}}]);